-# ページタイトル
- content_for(:title) { '出品 - メルカリ サンプル' }

-# コンテンツ
.payment
  %h2.payment__head 購入を確定しますか？
  -# 商品情報
  .payment__group
    .payment__group__content
      = @images.present? ? (image_tag @images.first.name.url, alt: '商品画像', class: 'payment__group__content__item-image') : (image_tag 'common/no_image.png', alt: '画像がありません', class: 'payment__group__content__item-image')
      %h3.payment__group__content__item-head= @item.name
      .payment__group__content__item
        %span.payment__group__content__item__price= "¥ #{number_with_delimiter(@item.price)}"
        %span.payment__group__content__item__fee= (@item.shipping_fee == "including_postage") ? "送料込み" : "着払い"
      -# TODO:ポイント機能実装後、ポイントボタン修正
      .payment__group__content__button--none ポイントはありません
      .payment__group__content__item__space
        %span.payment__group__content__item__price 支払い金額
        %span.payment__group__content__item__price= "¥ #{number_with_delimiter(@item.price)}"
      - if @credit_card.present? && @profile.prefecture.present? && @profile.city.present? && @profile.block.present? && @profile.first_name.present? && @profile.last_name.present?
        -# TODO:pay.jpのフォームに修正
        = link_to '購入する', '#', class: 'payment__group__content__item__purchase'
      - else
        .payment__group__content__caution
          - if @profile.prefecture.blank? || @profile.city.blank? || @profile.block.blank? || @profile.first_name.blank? || @profile.last_name.blank?
            %span 配送先
          - if @credit_card.blank?
            %span 支払い方法
          %span を登録してください
        .payment__group__content__item__space
          - if @profile.prefecture.present? && @profile.city.present? && @profile.block.present? && @profile.first_name.present? && @profile.last_name.present?
            .payment__group__content__item__registration--already 配送先を登録する
          - else
            = link_to '配送先を登録する', mypage_identification_path, class: 'payment__group__content__item__registration'
          - if @credit_card.present?
            .payment__group__content__item__registration--already 支払い方法を登録する
          - else
            = link_to '支払い方法を登録する', mypage_identification_path, class: 'payment__group__content__item__registration' if @credit_card.blank?
      .payment__group__content__app アプリをお持ちでない方は以下よりインストールしてご利用いただけます。
      .payment__group__content__item__store-image
        = image_tag 'common/app-store.svg', alt: 'App Store'
        = image_tag 'common/google-play.svg', alt: 'Google Play'

  -# 配送先情報
  - if @profile.prefecture.present? && @profile.city.present? && @profile.block.present? && @profile.first_name.present? && @profile.last_name.present?
    .payment__group
      .payment__group__content
        %h3.payment__group__content__head 配送先
        .payment__group__content__info= "〒 #{@profile.set_hyphen}"
        .payment__group__content__info= @profile.set_address
        .payment__group__content__info= @profile.set_fullname
        = link_to mypage_identification_path, class: 'payment__group__content__another-link' do
          %span 変更する
          %i.fas.fa-chevron-right

  -# クレジットカード情報
  - if @credit_card.present?
    .payment__group
      .payment__group__content
        %h3.payment__group__content__head 支払い方法
        .payment__group__content__info= @credit_card.hide_numbers
        .payment__group__content__info= "#{@credit_card.month} / #{@credit_card.year}"
        = image_tag "common/#{@credit_card.get_type}.svg", alt: "#{@credit_card.get_type}", class: 'payment__group__content__image' if @credit_card.get_type.present?
        = link_to mypage_card_index_path, class: 'payment__group__content__another-link' do
          %span 変更する
          %i.fas.fa-chevron-right
